
% Default to the notebook output style

    


% Inherit from the specified cell style.




    
\documentclass[11pt]{article}

    
    
    \usepackage[T1]{fontenc}
    % Nicer default font (+ math font) than Computer Modern for most use cases
    \usepackage{mathpazo}

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % We will generate all images so they have a width \maxwidth. This means
    % that they will get their normal width if they fit onto the page, but
    % are scaled down if they would overflow the margins.
    \makeatletter
    \def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth
    \else\Gin@nat@width\fi}
    \makeatother
    \let\Oldincludegraphics\includegraphics
    % Set max figure width to be 80% of text width, for now hardcoded.
    \renewcommand{\includegraphics}[1]{\Oldincludegraphics[width=.8\maxwidth]{#1}}
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionLabelFormat{nolabel}{}
    \captionsetup{labelformat=nolabel}

    \usepackage{adjustbox} % Used to constrain images to a maximum size 
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage[utf8x]{inputenc} % Allow utf-8 characters in the tex document
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range 
    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    \usepackage{mathrsfs}
    

    
    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}
    \definecolor{ansi-default-inverse-fg}{HTML}{FFFFFF}
    \definecolor{ansi-default-inverse-bg}{HTML}{000000}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatibility definitions
    \def\gt{>}
    \def\lt{<}
    \let\Oldtex\TeX
    \let\Oldlatex\LaTeX
    \renewcommand{\TeX}{\textrm{\Oldtex}}
    \renewcommand{\LaTeX}{\textrm{\Oldlatex}}
    % Document parameters
    % Document title
    \title{GSPNet\_prototype}
    
    
    
    
    

    % Pygments definitions
    
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\expandafter\def\csname PY@tok@w\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PY@tok@c\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\expandafter\def\csname PY@tok@k\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\expandafter\def\csname PY@tok@o\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ow\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@nb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@ne\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\expandafter\def\csname PY@tok@nv\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@no\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@nl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@ni\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\expandafter\def\csname PY@tok@na\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\expandafter\def\csname PY@tok@nt\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@s\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sd\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@si\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@se\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\expandafter\def\csname PY@tok@sr\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@ss\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sx\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@m\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@gh\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gu\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@gi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@gr\endcsname{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@ge\endcsname{\let\PY@it=\textit}
\expandafter\def\csname PY@tok@gs\endcsname{\let\PY@bf=\textbf}
\expandafter\def\csname PY@tok@gp\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@go\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\expandafter\def\csname PY@tok@gt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PY@tok@err\endcsname{\def\PY@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PY@tok@kc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kd\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kr\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@bp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@fm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@vc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vg\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sa\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@dl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s2\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s1\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@mb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@il\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mo\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ch\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cm\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cpf\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@c1\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cs\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % Exact colors from NB
    \definecolor{incolor}{rgb}{0.0, 0.0, 0.5}
    \definecolor{outcolor}{rgb}{0.545, 0.0, 0.0}



    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

    \begin{document}
    
    
    \maketitle
    
    

    
    

    \section{Dissertation Early Draft:}\label{dissertation-early-draft}

\section{Training A Graph State Prediction
Network}\label{training-a-graph-state-prediction-network}

This notebook is a prototype on how to train a graph state prediction
network using CNN and LSTM. The content is devided into \textbf{3}
parts:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Data preprocessing and wrangling
\item
  Model building
\item
  Tuning and Training
\end{enumerate}

The model is built with \href{https://pytorch.org/}{PyTorch}

\subsection{Part 1: Data Preprocessing and
Wrangling}\label{part-1-data-preprocessing-and-wrangling}

\subsubsection{1. Import necessary
libraries:}\label{import-necessary-libraries}

We will use pandas and numpy as main data examine and cleansing util and
use dask to handle parallel computing cases

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}1}]:} \PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
        \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
        \PY{k+kn}{import} \PY{n+nn}{seaborn} \PY{k}{as} \PY{n+nn}{sns}
        \PY{k+kn}{import} \PY{n+nn}{sqlalchemy}
        \PY{k+kn}{import} \PY{n+nn}{dask}
        \PY{k+kn}{import} \PY{n+nn}{time}
        \PY{k+kn}{import} \PY{n+nn}{psycopg2}
        \PY{k+kn}{import} \PY{n+nn}{warnings}
        \PY{k+kn}{from} \PY{n+nn}{PIL} \PY{k}{import} \PY{n}{Image}
        \PY{k+kn}{from} \PY{n+nn}{scipy} \PY{k}{import} \PY{n}{stats}
        \PY{k+kn}{from} \PY{n+nn}{matplotlib} \PY{k}{import} \PY{n}{pyplot} \PY{k}{as} \PY{n}{plt}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}51}]:} \PY{o}{\PYZpc{}}\PY{k}{matplotlib} inline
         \PY{o}{\PYZpc{}}\PY{k}{config} InlineBackend.figure\PYZus{}format = \PYZsq{}retina\PYZsq{}
\end{Verbatim}

    First, use a small sample data (approximately 1 million rows):

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}3}]:} \PY{c+c1}{\PYZsh{} Load already cleaned data sample}
        \PY{n}{table} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dataset/nytaxi\PYZus{}yellow\PYZus{}2017\PYZus{}jan.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{table}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}3}]:}      tripid tpep\_pickup\_datetime tpep\_dropoff\_datetime  pulocationid  \textbackslash{}
        0  25754898  2017-01-09 11:13:00   2017-01-09 11:25:00           263   
        1  25754899  2017-01-09 11:32:00   2017-01-09 11:36:00           186   
        2  25754900  2017-01-09 11:38:00   2017-01-09 11:42:00           164   
        3  25754901  2017-01-09 11:52:00   2017-01-09 11:57:00           236   
        4  25754903  2017-01-01 00:00:00   2017-01-01 00:03:00            48   
        
           dolocationid  trip\_distance  passenger\_count  total\_amount trip\_time  \textbackslash{}
        0           161            3.3                1         15.30  00:12:00   
        1           234            0.9                1          7.25  00:04:00   
        2           161            1.1                1          7.30  00:04:00   
        3            75            1.1                1          8.50  00:05:00   
        4            48            0.5                1          5.30  00:03:00   
        
           trip\_avg\_speed  trip\_time\_sec  
        0            16.5            720  
        1            13.5            240  
        2            16.5            240  
        3            13.2            300  
        4            10.0            180  
\end{Verbatim}
            
    \subsubsection{2. First sight of the
data}\label{first-sight-of-the-data}

Let's see the the type of columns and some basic statistics of the
sample data:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}4}]:} \PY{n}{table}\PY{o}{.}\PY{n}{dtypes}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}4}]:} tripid                     int64
        tpep\_pickup\_datetime      object
        tpep\_dropoff\_datetime     object
        pulocationid               int64
        dolocationid               int64
        trip\_distance            float64
        passenger\_count            int64
        total\_amount             float64
        trip\_time                 object
        trip\_avg\_speed           float64
        trip\_time\_sec              int64
        dtype: object
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}5}]:} \PY{n}{table}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}5}]:} (1040001, 11)
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}6}]:} \PY{n}{table}\PY{o}{.}\PY{n}{describe}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}6}]:}              tripid  pulocationid  dolocationid  trip\_distance  \textbackslash{}
        count  1.040001e+06  1.040001e+06  1.040001e+06   1.040001e+06   
        mean   2.627946e+07  1.610259e+02  1.591211e+02   3.033442e+00   
        std    3.026837e+05  6.767791e+01  7.193925e+01   3.800200e+00   
        min    2.575490e+07  1.000000e+00  1.000000e+00   1.000000e-02   
        25\%    2.601747e+07  1.130000e+02  1.070000e+02   1.000000e+00   
        50\%    2.627957e+07  1.610000e+02  1.620000e+02   1.700000e+00   
        75\%    2.654161e+07  2.320000e+02  2.330000e+02   3.200000e+00   
        max    2.680347e+07  2.650000e+02  2.650000e+02   1.517000e+02   
        
               passenger\_count  total\_amount  trip\_avg\_speed  trip\_time\_sec  
        count     1.040001e+06  1.040001e+06    1.040001e+06   1.040001e+06  
        mean      1.681332e+00  1.552271e+01    1.294343e+01   9.029197e+02  
        std       1.291006e+00  1.342812e+01    1.041047e+01   3.373064e+03  
        min       0.000000e+00 -9.470000e+01    4.341534e-04   6.000000e+01  
        25\%       1.000000e+00  8.160000e+00    8.400000e+00   3.600000e+02  
        50\%       1.000000e+00  1.130000e+01    1.133333e+01   6.000000e+02  
        75\%       2.000000e+00  1.680000e+01    1.530000e+01   9.600000e+02  
        max       6.000000e+00  1.000290e+03    1.914000e+03   8.640000e+04  
\end{Verbatim}
            
    The columns we will use are: \textbf{tpep\_pickup\_datetime,
pulocationid, tpep\_dropoff\_datetime, dolocationid.} These information
are used to generate graphs that are used to discribe the general
traffic state of New York.

Notice currently the \textbf{tpep\_pickup\_datetime} and
\textbf{tpep\_dropoff\_datetime} are of type \texttt{object}:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}7}]:} \PY{n}{table}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tpep\PYZus{}pickup\PYZus{}datetime}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tpep\PYZus{}dropoff\PYZus{}datetime}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}7}]:}   tpep\_pickup\_datetime tpep\_dropoff\_datetime
        0  2017-01-09 11:13:00   2017-01-09 11:25:00
        1  2017-01-09 11:32:00   2017-01-09 11:36:00
        2  2017-01-09 11:38:00   2017-01-09 11:42:00
        3  2017-01-09 11:52:00   2017-01-09 11:57:00
        4  2017-01-01 00:00:00   2017-01-01 00:03:00
\end{Verbatim}
            
    In order to do \textbf{time slice} later, these two feilds must be
sorted in chronological mananer, first by
\texttt{tpep\_pickup\_datetime} and then by
\texttt{tpep\_dropoff\_datetime}, as follows:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}8}]:} \PY{n}{table}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{n}{by}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tpep\PYZus{}pickup\PYZus{}datetime}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tpep\PYZus{}dropoff\PYZus{}datetime}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)} \PY{c+c1}{\PYZsh{} pick first 10 rows}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}8}]:}       tripid tpep\_pickup\_datetime tpep\_dropoff\_datetime  pulocationid  \textbackslash{}
        23  25754922  2017-01-01 00:00:00   2017-01-01 00:01:00           143   
        37  25754937  2017-01-01 00:00:00   2017-01-01 00:01:00           243   
        68  25754969  2017-01-01 00:00:00   2017-01-01 00:01:00           239   
        19  25754918  2017-01-01 00:00:00   2017-01-01 00:02:00            36   
        4   25754903  2017-01-01 00:00:00   2017-01-01 00:03:00            48   
        38  25754938  2017-01-01 00:00:00   2017-01-01 00:03:00           161   
        39  25754939  2017-01-01 00:00:00   2017-01-01 00:03:00            50   
        43  25754943  2017-01-01 00:00:00   2017-01-01 00:03:00            74   
        49  25754949  2017-01-01 00:00:00   2017-01-01 00:03:00           236   
        70  25754971  2017-01-01 00:00:00   2017-01-01 00:03:00           137   
        
            dolocationid  trip\_distance  passenger\_count  total\_amount trip\_time  \textbackslash{}
        23           143           0.20                2          4.30  00:01:00   
        37           243           0.10                1          4.30  00:01:00   
        68           238           0.41                2          5.52  00:01:00   
        19            37           0.50                1          5.30  00:02:00   
        4             48           0.50                1          5.30  00:03:00   
        38           161           0.24                1          6.36  00:03:00   
        39           246           0.92                1          7.25  00:03:00   
        43            75           0.56                3          5.80  00:03:00   
        49           236           0.90                4          6.30  00:03:00   
        70           137           2.20                1          4.80  00:03:00   
        
            trip\_avg\_speed  trip\_time\_sec  
        23            12.0             60  
        37             6.0             60  
        68            24.6             60  
        19            15.0            120  
        4             10.0            180  
        38             4.8            180  
        39            18.4            180  
        43            11.2            180  
        49            18.0            180  
        70            44.0            180  
\end{Verbatim}
            
    We can see from above that the taxi trips are nicely sorted according to
\textbf{time}. What we need to do is convert this tabular date into
graphs that described by \textbf{adjacency matrice}.

First, let's see what are \texttt{pulocationid} and
\texttt{dolocationid}:

    They are code number for a district in Manhattan, New York. We will
mainly describe the traffic state and prediction at \textbf{this} level.

    \subsubsection{3. Time slicing}\label{time-slicing}

Now we've done a very superficial exploration of the data. It's time to
convert the tabular data to graphs that are to be fed into our neural
network model.

The first problem is, \textbf{how to decide a feasible time interval?}

Of course, the time interval should be a varaible that is to be selected
\textbf{per need. However,} it is a reasonable thinking to let a time
interval (i.e. a \textbf{snapshot}) to contain as many as
\textbf{complete trip} as possible. See the diagram below:

    \paragraph{\texorpdfstring{\textbf{If the time interval is too
small}:}{If the time interval is too small:}}\label{if-the-time-interval-is-too-small}

The majority of the matrices will be very sparse or even completely
blank.

\paragraph{If the time interval is too
big:}\label{if-the-time-interval-is-too-big}

Then information about trips will be densely squeezed into one matrix
and a lot of details on changes along time will be lost.

Thus, it is important to choose time interval wisely. Let's look at the
data again:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}9}]:} \PY{n}{table}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{trip\PYZus{}distance}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{trip\PYZus{}time\PYZus{}sec}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{trip\PYZus{}avg\PYZus{}speed}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{describe}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}9}]:}        trip\_distance  trip\_time\_sec  trip\_avg\_speed
        count   1.040001e+06   1.040001e+06    1.040001e+06
        mean    3.033442e+00   9.029197e+02    1.294343e+01
        std     3.800200e+00   3.373064e+03    1.041047e+01
        min     1.000000e-02   6.000000e+01    4.341534e-04
        25\%     1.000000e+00   3.600000e+02    8.400000e+00
        50\%     1.700000e+00   6.000000e+02    1.133333e+01
        75\%     3.200000e+00   9.600000e+02    1.530000e+01
        max     1.517000e+02   8.640000e+04    1.914000e+03
\end{Verbatim}
            
    The an average trip lasts for roughly 900 seconds, which is \textbf{15
minutes}.

The median(i.e. 50\% percentile) is roughly 600 seconds, which is
\textbf{10 minutes}.

Let's plot the distribution of column \texttt{trip\_time\_sec} to have a
better intuition:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}10}]:} \PY{n}{warnings}\PY{o}{.}\PY{n}{simplefilter}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ignore}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{sns}\PY{o}{.}\PY{n}{set}\PY{p}{(}\PY{n}{color\PYZus{}codes}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
         \PY{n}{sns}\PY{o}{.}\PY{n}{distplot}\PY{p}{(}\PY{n}{table}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{trip\PYZus{}time\PYZus{}sec}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{;}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_20_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    It seems that the trips are mostly concentrated in a shorter time range,
while some outliers may significantly biased the average.

Let's see how how many trips are longer than 30 minutes (1800 secs):

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}11}]:} \PY{n}{table}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{table}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{trip\PYZus{}time\PYZus{}sec}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{\PYZgt{}} \PY{l+m+mi}{1800}\PY{p}{]}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{/} \PY{l+m+mi}{1040001} \PY{c+c1}{\PYZsh{} divided by total number of rows}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}11}]:} 0.05949609663836862
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}12}]:} \PY{n}{table}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{table}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{trip\PYZus{}time\PYZus{}sec}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{\PYZgt{}} \PY{l+m+mi}{900}\PY{p}{]}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{/} \PY{l+m+mi}{1040001}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}12}]:} 0.27779780980979824
\end{Verbatim}
            
    There are \textbf{95\%} of the trips last shorter than 30 minutes, let's
plot distribution at this range:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}13}]:} \PY{n}{temp} \PY{o}{=} \PY{n}{table}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{table}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{trip\PYZus{}time\PYZus{}sec}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{\PYZlt{}} \PY{l+m+mi}{1800}\PY{p}{]}
         \PY{n}{sns}\PY{o}{.}\PY{n}{distplot}\PY{p}{(}\PY{n}{temp}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{trip\PYZus{}time\PYZus{}sec}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{;}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_25_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}14}]:} \PY{n}{temp}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{trip\PYZus{}distance}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{trip\PYZus{}time\PYZus{}sec}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{trip\PYZus{}avg\PYZus{}speed}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{describe}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}14}]:}        trip\_distance  trip\_time\_sec  trip\_avg\_speed
         count  971920.000000  971920.000000   971920.000000
         mean        2.383037     657.905136       12.557337
         std         2.460777     387.336369       10.357605
         min         0.010000      60.000000        0.024000
         25\%         0.990000     360.000000        8.400000
         50\%         1.600000     600.000000       11.142857
         75\%         2.800000     900.000000       14.820000
         max        31.900000    1740.000000     1914.000000
\end{Verbatim}
            
    More than 50\% of the trips have trip time between 6 to 15 minutes, with
a median of 10 minutes.

\paragraph{As a result, we primarily decide to use 10 minutes as time
interval.}\label{as-a-result-we-primarily-decide-to-use-10-minutes-as-time-interval.}

    \subsubsection{4. From tabular data to
graph}\label{from-tabular-data-to-graph}

Since we have decided a time interval, it's time to generate matrices.
Basically, the idea is shown as figure below:

    Apart from \textbf{outgoin} and \textbf{incoming} matrices shown above,
an additional \textbf{Domestic} matrix is add because 50\% of trips last
less than the \textbf{chosen interval 10 minutes}. Such matrices can be
combined into a \textbf{Tensor} illustrated as follows:

    \paragraph{STRICT DEFINITION OF OID
layers}\label{strict-definition-of-oid-layers}

\begin{itemize}
\tightlist
\item
  \textbf{O}utgoing layer Condition:

  \begin{enumerate}
  \def\labelenumi{\arabic{enumi}.}
  \tightlist
  \item
    subtable sorted by tpep\_\textbf{pickup}\_datetime
  \item
    left bound of interval \textless{}= tpep\_pickup\_datetime
    \textless{} right bound of interval
  \item
    right bound of interval \textless{}= tpep\_dropoff\_datetime
  \end{enumerate}
\item
  \textbf{I}ncoming layer Condition:

  \begin{enumerate}
  \def\labelenumi{\arabic{enumi}.}
  \tightlist
  \item
    subtable sorted by tpep\_\textbf{dropoff}\_datetime
  \item
    left bound of interval \textless{}= tpep\_dropoff\_datetime
    \textless{} right bound of interval
  \item
    tpep\_pickup\_datetime \textless{} left bound of interval
  \end{enumerate}
\item
  \textbf{D}omestic layer Condition:

  \begin{enumerate}
  \def\labelenumi{\arabic{enumi}.}
  \tightlist
  \item
    subtable sorted by either tpep\_\textbf{pickup}\_datetime or
    tpep\_\textbf{dropoff}\_datetime, but only count **once*.
  \item
    left bound of interval \textless{}= tpep\_pickup\_datetime
    \textless{} tpep\_dropoff\_datetime \textless{} right bound of
    interval
  \end{enumerate}
\end{itemize}

    \paragraph{Extract relevant columns:}\label{extract-relevant-columns}

To generate tensor defined above, \textbf{four} key columns are
needed.They are \texttt{tpep\_pickup\_datetime},
\texttt{tpep\_dropoff\_datetime}, \texttt{pulocationid} and
\texttt{dolocationid}.

We first extract them from original table:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}15}]:} \PY{c+c1}{\PYZsh{} draw four needed columns and a id column, then sort according to time.}
         \PY{c+c1}{\PYZsh{} the `tripid` column is for the sake of naming.}
         \PY{n}{tensor\PYZus{}gen\PYZus{}o} \PY{o}{=} \PY{n}{table}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tripid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                   \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tpep\PYZus{}pickup\PYZus{}datetime}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                   \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tpep\PYZus{}dropoff\PYZus{}datetime}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                   \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pulocationid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dolocationid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
                               \PY{p}{]}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{n}{by}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tpep\PYZus{}pickup\PYZus{}datetime}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tpep\PYZus{}dropoff\PYZus{}datetime}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)} \PY{c+c1}{\PYZsh{} the first sort condition rules}
         \PY{n}{tensor\PYZus{}gen\PYZus{}o}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}15}]:}       tripid tpep\_pickup\_datetime tpep\_dropoff\_datetime  pulocationid  \textbackslash{}
         23  25754922  2017-01-01 00:00:00   2017-01-01 00:01:00           143   
         37  25754937  2017-01-01 00:00:00   2017-01-01 00:01:00           243   
         68  25754969  2017-01-01 00:00:00   2017-01-01 00:01:00           239   
         19  25754918  2017-01-01 00:00:00   2017-01-01 00:02:00            36   
         4   25754903  2017-01-01 00:00:00   2017-01-01 00:03:00            48   
         
             dolocationid  
         23           143  
         37           243  
         68           238  
         19            37  
         4             48  
\end{Verbatim}
            
    \paragraph{Slice the table to sub-tables according to time interval (10
min)}\label{slice-the-table-to-sub-tables-according-to-time-interval-10-min}

Since the columns are extracted, now it's time to generate tensors.

The dataset is trip data of all yellow taxi cabs in Manhattan area in
\textbf{January}, 2017.As we are making 10-minute-splices, there will be
total:

\[
6 \times 24 \times 31 = 4464 \space slices(i.e. \space snapshots)
\]

Each slice has 3 layers, that is in total

\[
4464 \times 3 = 13392 \space matrices
\] to be generated.

First, let's try to generate one image (i.e. a \emph{tensor} with
\textbf{3} layers).

The time columns need to be converted to pandas timestamp type in order
to compare:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}16}]:} \PY{c+c1}{\PYZsh{} current type is python str}
         \PY{n+nb}{type}\PY{p}{(}\PY{n}{tensor\PYZus{}gen\PYZus{}o}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}16}]:} str
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}17}]:} \PY{c+c1}{\PYZsh{} convert to timestamp}
         \PY{n}{pd}\PY{o}{.}\PY{n}{to\PYZus{}datetime}\PY{p}{(}\PY{n}{tensor\PYZus{}gen\PYZus{}o}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}17}]:} Timestamp('2017-01-01 00:00:00')
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}18}]:} \PY{n}{t1} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{to\PYZus{}datetime}\PY{p}{(}\PY{n}{tensor\PYZus{}gen\PYZus{}o}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)} \PY{c+c1}{\PYZsh{} 2017\PYZhy{}01\PYZhy{}01 00:00:00}
         \PY{n}{t2} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{to\PYZus{}datetime}\PY{p}{(}\PY{n}{tensor\PYZus{}gen\PYZus{}o}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{)} \PY{c+c1}{\PYZsh{} 2017\PYZhy{}01\PYZhy{}01 00:01:00}
         \PY{n}{t1} \PY{o}{\PYZlt{}} \PY{n}{t2} \PY{c+c1}{\PYZsh{} test if can compare time}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}18}]:} True
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}19}]:} \PY{c+c1}{\PYZsh{} apply type cast to all values:}
         \PY{n}{tensor\PYZus{}gen\PYZus{}o}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tpep\PYZus{}pickup\PYZus{}datetime}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{to\PYZus{}datetime}\PY{p}{(}\PY{n}{tensor\PYZus{}gen\PYZus{}o}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tpep\PYZus{}pickup\PYZus{}datetime}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{tensor\PYZus{}gen\PYZus{}o}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tpep\PYZus{}dropoff\PYZus{}datetime}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{to\PYZus{}datetime}\PY{p}{(}\PY{n}{tensor\PYZus{}gen\PYZus{}o}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tpep\PYZus{}dropoff\PYZus{}datetime}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         
         \PY{n}{tensor\PYZus{}gen\PYZus{}o}\PY{o}{.}\PY{n}{dtypes}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}19}]:} tripid                            int64
         tpep\_pickup\_datetime     datetime64[ns]
         tpep\_dropoff\_datetime    datetime64[ns]
         pulocationid                      int64
         dolocationid                      int64
         dtype: object
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}20}]:} \PY{n}{tensor\PYZus{}gen\PYZus{}o}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}20}]:}       tripid tpep\_pickup\_datetime tpep\_dropoff\_datetime  pulocationid  \textbackslash{}
         23  25754922           2017-01-01   2017-01-01 00:01:00           143   
         37  25754937           2017-01-01   2017-01-01 00:01:00           243   
         68  25754969           2017-01-01   2017-01-01 00:01:00           239   
         19  25754918           2017-01-01   2017-01-01 00:02:00            36   
         4   25754903           2017-01-01   2017-01-01 00:03:00            48   
         
             dolocationid  
         23           143  
         37           243  
         68           238  
         19            37  
         4             48  
\end{Verbatim}
            
    The interval \textbf{boundaries} are fixed when interval is set.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}60}]:} \PY{c+c1}{\PYZsh{} create intervals}
         \PY{n}{intervals} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{date\PYZus{}range}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{2017\PYZhy{}01\PYZhy{}01 00:00:00}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{2017\PYZhy{}02\PYZhy{}01 00:00:00}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{freq}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{10min}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{intervals}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}60}]:} DatetimeIndex(['2017-01-01 00:00:00', '2017-01-01 00:10:00',
                        '2017-01-01 00:20:00', '2017-01-01 00:30:00',
                        '2017-01-01 00:40:00', '2017-01-01 00:50:00',
                        '2017-01-01 01:00:00', '2017-01-01 01:10:00',
                        '2017-01-01 01:20:00', '2017-01-01 01:30:00',
                        {\ldots}
                        '2017-01-31 22:30:00', '2017-01-31 22:40:00',
                        '2017-01-31 22:50:00', '2017-01-31 23:00:00',
                        '2017-01-31 23:10:00', '2017-01-31 23:20:00',
                        '2017-01-31 23:30:00', '2017-01-31 23:40:00',
                        '2017-01-31 23:50:00', '2017-02-01 00:00:00'],
                       dtype='datetime64[ns]', length=4465, freq='10T')
\end{Verbatim}
            
    \textbf{Notice}: When splicing time interval int such manner, we are
assuming the \textbf{entire} month is monitored. Under this setting, we
do not consider another day is a 'fresh start'.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}61}]:} \PY{n}{intervals}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}61}]:} Timestamp('2017-01-01 00:10:00', freq='10T')
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}62}]:} \PY{c+c1}{\PYZsh{} First subtb:}
         \PY{n}{first} \PY{o}{=} \PY{n}{tensor\PYZus{}gen\PYZus{}o}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{tensor\PYZus{}gen\PYZus{}o}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tpep\PYZus{}pickup\PYZus{}datetime}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{\PYZlt{}} \PY{n}{intervals}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{]}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{shape is: }\PY{l+s+si}{\PYZob{}first.shape\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{first}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
shape is: (1751, 5)

    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}62}]:}       tripid tpep\_pickup\_datetime tpep\_dropoff\_datetime  pulocationid  \textbackslash{}
         23  25754922           2017-01-01   2017-01-01 00:01:00           143   
         37  25754937           2017-01-01   2017-01-01 00:01:00           243   
         68  25754969           2017-01-01   2017-01-01 00:01:00           239   
         19  25754918           2017-01-01   2017-01-01 00:02:00            36   
         4   25754903           2017-01-01   2017-01-01 00:03:00            48   
         
             dolocationid  
         23           143  
         37           243  
         68           238  
         19            37  
         4             48  
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}63}]:} \PY{c+c1}{\PYZsh{} sort to have a clearer look:}
         \PY{n}{first}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{n}{by}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pulocationid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dolocationid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{20}\PY{p}{)}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}63}]:}           tripid tpep\_pickup\_datetime tpep\_dropoff\_datetime  pulocationid  \textbackslash{}
         182869  25939738  2017-01-01 00:02:00   2017-01-01 00:09:00             4   
         183253  25940126  2017-01-01 00:04:00   2017-01-01 00:08:00             4   
         183415  25940290  2017-01-01 00:05:00   2017-01-01 00:10:00             4   
         183997  25940882  2017-01-01 00:08:00   2017-01-01 00:15:00             4   
         184070  25940955  2017-01-01 00:08:00   2017-01-01 00:11:00             4   
         183112  25939983  2017-01-01 00:03:00   2017-01-01 00:10:00             4   
         183426  25940301  2017-01-01 00:05:00   2017-01-01 00:17:00             4   
         182933  25939803  2017-01-01 00:02:00   2017-01-01 00:03:00             7   
         183105  25939976  2017-01-01 00:03:00   2017-01-01 00:06:00             7   
         183005  25939875  2017-01-01 00:03:00   2017-01-01 00:07:00             7   
         183289  25940162  2017-01-01 00:05:00   2017-01-01 00:24:00             7   
         182978  25939848  2017-01-01 00:03:00   2017-01-01 00:17:00             7   
         183467  25940343  2017-01-01 00:06:00   2017-01-01 00:13:00             7   
         183802  25940683  2017-01-01 00:07:00   2017-01-01 00:09:00            13   
         183671  25940549  2017-01-01 00:06:00   2017-01-01 00:20:00            13   
         184139  25941026  2017-01-01 00:08:00   2017-01-01 00:13:00            13   
         183436  25940311  2017-01-01 00:05:00   2017-01-01 00:10:00            17   
         183269  25940142  2017-01-01 00:04:00   2017-01-01 00:40:00            17   
         183235  25940108  2017-01-01 00:04:00   2017-01-01 00:06:00            24   
         183421  25940296  2017-01-01 00:05:00   2017-01-01 00:16:00            24   
         
                 dolocationid  
         182869            79  
         183253            79  
         183415            79  
         183997           114  
         184070           224  
         183112           232  
         183426           249  
         182933             7  
         183105             7  
         183005             7  
         183289            36  
         182978            82  
         183467           193  
         183802            13  
         183671            90  
         184139           158  
         183436            17  
         183269           164  
         183235            41  
         183421            42  
\end{Verbatim}
            
    The \texttt{first} will generate Outgoing, Incoming and Domestic layers,
that is, 3 matrices of size:

\[
(number \space of\space zones)\space \times \space (number\space of\space zones)
\]

Let's see the zone numbers:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}85}]:} \PY{c+c1}{\PYZsh{} Load zone lookup table}
         \PY{n}{zones} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dataset/taxi\PYZus{}zone\PYZus{}lookup.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{shape is: }\PY{l+s+si}{\PYZob{}zones.shape\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{zones}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
shape is: (265, 4)

    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}85}]:}      LocationID        Borough                                 Zone  \textbackslash{}
         0             1            EWR                       Newark Airport   
         1             2         Queens                          Jamaica Bay   
         2             3          Bronx              Allerton/Pelham Gardens   
         3             4      Manhattan                        Alphabet City   
         4             5  Staten Island                        Arden Heights   
         5             6  Staten Island              Arrochar/Fort Wadsworth   
         6             7         Queens                              Astoria   
         7             8         Queens                         Astoria Park   
         8             9         Queens                           Auburndale   
         9            10         Queens                         Baisley Park   
         10           11       Brooklyn                           Bath Beach   
         11           12      Manhattan                         Battery Park   
         12           13      Manhattan                    Battery Park City   
         13           14       Brooklyn                            Bay Ridge   
         14           15         Queens              Bay Terrace/Fort Totten   
         15           16         Queens                              Bayside   
         16           17       Brooklyn                              Bedford   
         17           18          Bronx                         Bedford Park   
         18           19         Queens                            Bellerose   
         19           20          Bronx                              Belmont   
         20           21       Brooklyn                     Bensonhurst East   
         21           22       Brooklyn                     Bensonhurst West   
         22           23  Staten Island              Bloomfield/Emerson Hill   
         23           24      Manhattan                         Bloomingdale   
         24           25       Brooklyn                          Boerum Hill   
         25           26       Brooklyn                         Borough Park   
         26           27         Queens  Breezy Point/Fort Tilden/Riis Beach   
         27           28         Queens              Briarwood/Jamaica Hills   
         28           29       Brooklyn                       Brighton Beach   
         29           30         Queens                        Broad Channel   
         ..          {\ldots}            {\ldots}                                  {\ldots}   
         235         236      Manhattan                Upper East Side North   
         236         237      Manhattan                Upper East Side South   
         237         238      Manhattan                Upper West Side North   
         238         239      Manhattan                Upper West Side South   
         239         240          Bronx                   Van Cortlandt Park   
         240         241          Bronx                Van Cortlandt Village   
         241         242          Bronx                 Van Nest/Morris Park   
         242         243      Manhattan             Washington Heights North   
         243         244      Manhattan             Washington Heights South   
         244         245  Staten Island                        West Brighton   
         245         246      Manhattan            West Chelsea/Hudson Yards   
         246         247          Bronx                       West Concourse   
         247         248          Bronx               West Farms/Bronx River   
         248         249      Manhattan                         West Village   
         249         250          Bronx        Westchester Village/Unionport   
         250         251  Staten Island                          Westerleigh   
         251         252         Queens                           Whitestone   
         252         253         Queens                        Willets Point   
         253         254          Bronx             Williamsbridge/Olinville   
         254         255       Brooklyn            Williamsburg (North Side)   
         255         256       Brooklyn            Williamsburg (South Side)   
         256         257       Brooklyn                      Windsor Terrace   
         257         258         Queens                            Woodhaven   
         258         259          Bronx                   Woodlawn/Wakefield   
         259         260         Queens                             Woodside   
         260         261      Manhattan                   World Trade Center   
         261         262      Manhattan                       Yorkville East   
         262         263      Manhattan                       Yorkville West   
         263         264        Unknown                                   NV   
         264         265        Unknown                                  NaN   
         
             service\_zone  
         0            EWR  
         1      Boro Zone  
         2      Boro Zone  
         3    Yellow Zone  
         4      Boro Zone  
         5      Boro Zone  
         6      Boro Zone  
         7      Boro Zone  
         8      Boro Zone  
         9      Boro Zone  
         10     Boro Zone  
         11   Yellow Zone  
         12   Yellow Zone  
         13     Boro Zone  
         14     Boro Zone  
         15     Boro Zone  
         16     Boro Zone  
         17     Boro Zone  
         18     Boro Zone  
         19     Boro Zone  
         20     Boro Zone  
         21     Boro Zone  
         22     Boro Zone  
         23   Yellow Zone  
         24     Boro Zone  
         25     Boro Zone  
         26     Boro Zone  
         27     Boro Zone  
         28     Boro Zone  
         29     Boro Zone  
         ..           {\ldots}  
         235  Yellow Zone  
         236  Yellow Zone  
         237  Yellow Zone  
         238  Yellow Zone  
         239    Boro Zone  
         240    Boro Zone  
         241    Boro Zone  
         242    Boro Zone  
         243    Boro Zone  
         244    Boro Zone  
         245  Yellow Zone  
         246    Boro Zone  
         247    Boro Zone  
         248  Yellow Zone  
         249    Boro Zone  
         250    Boro Zone  
         251    Boro Zone  
         252    Boro Zone  
         253    Boro Zone  
         254    Boro Zone  
         255    Boro Zone  
         256    Boro Zone  
         257    Boro Zone  
         258    Boro Zone  
         259    Boro Zone  
         260  Yellow Zone  
         261  Yellow Zone  
         262  Yellow Zone  
         263          NaN  
         264          NaN  
         
         [265 rows x 4 columns]
\end{Verbatim}
            
    Total 265 zones, indexing from 0 to 264.

Among which, we only care about \texttt{Yellow\ Zone} or
\texttt{Manhattan} area:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}102}]:} \PY{n}{y\PYZus{}zone} \PY{o}{=} \PY{n}{zones}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{zones}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Borough}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Manhattan}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n+nb}{print}\PY{p}{(}\PY{n}{y\PYZus{}zone}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
          \PY{n}{img\PYZus{}size} \PY{o}{=} \PY{n}{y\PYZus{}zone}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
          \PY{n}{y\PYZus{}zone}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
(69, 4)

    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}102}]:}      LocationID    Borough                                           Zone  \textbackslash{}
          3             4  Manhattan                                  Alphabet City   
          11           12  Manhattan                                   Battery Park   
          12           13  Manhattan                              Battery Park City   
          23           24  Manhattan                                   Bloomingdale   
          40           41  Manhattan                                 Central Harlem   
          41           42  Manhattan                           Central Harlem North   
          42           43  Manhattan                                   Central Park   
          44           45  Manhattan                                      Chinatown   
          47           48  Manhattan                                   Clinton East   
          49           50  Manhattan                                   Clinton West   
          67           68  Manhattan                                   East Chelsea   
          73           74  Manhattan                              East Harlem North   
          74           75  Manhattan                              East Harlem South   
          78           79  Manhattan                                   East Village   
          86           87  Manhattan                       Financial District North   
          87           88  Manhattan                       Financial District South   
          89           90  Manhattan                                       Flatiron   
          99          100  Manhattan                               Garment District   
          102         103  Manhattan  Governor's Island/Ellis Island/Liberty Island   
          103         104  Manhattan  Governor's Island/Ellis Island/Liberty Island   
          104         105  Manhattan  Governor's Island/Ellis Island/Liberty Island   
          106         107  Manhattan                                       Gramercy   
          112         113  Manhattan                        Greenwich Village North   
          113         114  Manhattan                        Greenwich Village South   
          115         116  Manhattan                               Hamilton Heights   
          119         120  Manhattan                                Highbridge Park   
          124         125  Manhattan                                      Hudson Sq   
          126         127  Manhattan                                         Inwood   
          127         128  Manhattan                               Inwood Hill Park   
          136         137  Manhattan                                       Kips Bay   
          ..          {\ldots}        {\ldots}                                            {\ldots}   
          157         158  Manhattan                  Meatpacking/West Village West   
          160         161  Manhattan                                 Midtown Center   
          161         162  Manhattan                                   Midtown East   
          162         163  Manhattan                                  Midtown North   
          163         164  Manhattan                                  Midtown South   
          165         166  Manhattan                            Morningside Heights   
          169         170  Manhattan                                    Murray Hill   
          185         186  Manhattan                   Penn Station/Madison Sq West   
          193         194  Manhattan                                Randalls Island   
          201         202  Manhattan                               Roosevelt Island   
          208         209  Manhattan                                        Seaport   
          210         211  Manhattan                                           SoHo   
          223         224  Manhattan                 Stuy Town/Peter Cooper Village   
          228         229  Manhattan                  Sutton Place/Turtle Bay North   
          229         230  Manhattan                      Times Sq/Theatre District   
          230         231  Manhattan                           TriBeCa/Civic Center   
          231         232  Manhattan                        Two Bridges/Seward Park   
          232         233  Manhattan                            UN/Turtle Bay South   
          233         234  Manhattan                                       Union Sq   
          235         236  Manhattan                          Upper East Side North   
          236         237  Manhattan                          Upper East Side South   
          237         238  Manhattan                          Upper West Side North   
          238         239  Manhattan                          Upper West Side South   
          242         243  Manhattan                       Washington Heights North   
          243         244  Manhattan                       Washington Heights South   
          245         246  Manhattan                      West Chelsea/Hudson Yards   
          248         249  Manhattan                                   West Village   
          260         261  Manhattan                             World Trade Center   
          261         262  Manhattan                                 Yorkville East   
          262         263  Manhattan                                 Yorkville West   
          
              service\_zone  
          3    Yellow Zone  
          11   Yellow Zone  
          12   Yellow Zone  
          23   Yellow Zone  
          40     Boro Zone  
          41     Boro Zone  
          42   Yellow Zone  
          44   Yellow Zone  
          47   Yellow Zone  
          49   Yellow Zone  
          67   Yellow Zone  
          73     Boro Zone  
          74     Boro Zone  
          78   Yellow Zone  
          86   Yellow Zone  
          87   Yellow Zone  
          89   Yellow Zone  
          99   Yellow Zone  
          102  Yellow Zone  
          103  Yellow Zone  
          104  Yellow Zone  
          106  Yellow Zone  
          112  Yellow Zone  
          113  Yellow Zone  
          115    Boro Zone  
          119    Boro Zone  
          124  Yellow Zone  
          126    Boro Zone  
          127    Boro Zone  
          136  Yellow Zone  
          ..           {\ldots}  
          157  Yellow Zone  
          160  Yellow Zone  
          161  Yellow Zone  
          162  Yellow Zone  
          163  Yellow Zone  
          165    Boro Zone  
          169  Yellow Zone  
          185  Yellow Zone  
          193  Yellow Zone  
          201    Boro Zone  
          208  Yellow Zone  
          210  Yellow Zone  
          223  Yellow Zone  
          228  Yellow Zone  
          229  Yellow Zone  
          230  Yellow Zone  
          231  Yellow Zone  
          232  Yellow Zone  
          233  Yellow Zone  
          235  Yellow Zone  
          236  Yellow Zone  
          237  Yellow Zone  
          238  Yellow Zone  
          242    Boro Zone  
          243    Boro Zone  
          245  Yellow Zone  
          248  Yellow Zone  
          260  Yellow Zone  
          261  Yellow Zone  
          262  Yellow Zone  
          
          [69 rows x 4 columns]
\end{Verbatim}
            
    Thus, the layers should be matrices of size (265, 265), and each
timeslice(snapshot) should be tensors of size (55, 55, 3).

Create the first tensor:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}103}]:} \PY{c+c1}{\PYZsh{} convert dtype for entire table here:}
          \PY{n}{table}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tpep\PYZus{}pickup\PYZus{}datetime}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{to\PYZus{}datetime}\PY{p}{(}\PY{n}{table}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tpep\PYZus{}pickup\PYZus{}datetime}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
          \PY{n}{table}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tpep\PYZus{}dropoff\PYZus{}datetime}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{to\PYZus{}datetime}\PY{p}{(}\PY{n}{table}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tpep\PYZus{}dropoff\PYZus{}datetime}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} O,I,D layers of first snapshot defined:}
          \PY{n}{tensor\PYZus{}gen\PYZus{}o} \PY{o}{=} \PY{n}{table}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tripid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tpep\PYZus{}pickup\PYZus{}datetime}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tpep\PYZus{}dropoff\PYZus{}datetime}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pulocationid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dolocationid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
                                \PY{p}{]}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{n}{by}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tpep\PYZus{}pickup\PYZus{}datetime}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tpep\PYZus{}dropoff\PYZus{}datetime}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)} \PY{c+c1}{\PYZsh{} the first sort condition rules}
          
          \PY{n}{tensor\PYZus{}gen\PYZus{}I} \PY{o}{=} \PY{n}{table}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tripid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tpep\PYZus{}pickup\PYZus{}datetime}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tpep\PYZus{}dropoff\PYZus{}datetime}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pulocationid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dolocationid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
                                \PY{p}{]}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{n}{by}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tpep\PYZus{}dropoff\PYZus{}datetime}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tpep\PYZus{}pickup\PYZus{}datetime}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)} \PY{c+c1}{\PYZsh{} the first sort condition rules}
          
          \PY{n}{tensor\PYZus{}gen\PYZus{}D} \PY{o}{=} \PY{n}{table}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tripid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tpep\PYZus{}pickup\PYZus{}datetime}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tpep\PYZus{}dropoff\PYZus{}datetime}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pulocationid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dolocationid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
                                \PY{p}{]}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{n}{by}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tpep\PYZus{}dropoff\PYZus{}datetime}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tpep\PYZus{}pickup\PYZus{}datetime}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)} \PY{c+c1}{\PYZsh{} whichever is ok}
          
          \PY{c+c1}{\PYZsh{} Their shape should be the same}
          \PY{k}{assert} \PY{n}{tensor\PYZus{}gen\PYZus{}o}\PY{o}{.}\PY{n}{shape} \PY{o}{==} \PY{n}{tensor\PYZus{}gen\PYZus{}I}\PY{o}{.}\PY{n}{shape} \PY{o}{==} \PY{n}{tensor\PYZus{}gen\PYZus{}D}\PY{o}{.}\PY{n}{shape}
          
          \PY{c+c1}{\PYZsh{} Check the condition of three layers above, if forgotten.}
          \PY{n}{f\PYZus{}olayer} \PY{o}{=} \PY{n}{tensor\PYZus{}gen\PYZus{}o}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{(}\PY{n}{tensor\PYZus{}gen\PYZus{}o}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tpep\PYZus{}pickup\PYZus{}datetime}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{\PYZlt{}} \PY{n}{intervals}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)} \PY{o}{\PYZam{}}
                                      \PY{p}{(}\PY{n}{tensor\PYZus{}gen\PYZus{}o}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tpep\PYZus{}pickup\PYZus{}datetime}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{\PYZgt{}}\PY{o}{=} \PY{n}{intervals}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)} \PY{o}{\PYZam{}}
                                      \PY{p}{(}\PY{n}{tensor\PYZus{}gen\PYZus{}o}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tpep\PYZus{}dropoff\PYZus{}datetime}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{\PYZgt{}}\PY{o}{=} \PY{n}{intervals}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
                                     \PY{p}{]}
          
          \PY{n}{f\PYZus{}Ilayer} \PY{o}{=} \PY{n}{tensor\PYZus{}gen\PYZus{}I}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{(}\PY{n}{tensor\PYZus{}gen\PYZus{}I}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tpep\PYZus{}pickup\PYZus{}datetime}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{\PYZlt{}} \PY{n}{intervals}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)} \PY{o}{\PYZam{}}
                                      \PY{p}{(}\PY{n}{tensor\PYZus{}gen\PYZus{}I}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tpep\PYZus{}dropoff\PYZus{}datetime}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{\PYZgt{}}\PY{o}{=} \PY{n}{intervals}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)} \PY{o}{\PYZam{}}
                                      \PY{p}{(}\PY{n}{tensor\PYZus{}gen\PYZus{}I}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tpep\PYZus{}dropoff\PYZus{}datetime}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{\PYZlt{}} \PY{n}{intervals}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
                                     \PY{p}{]}
          
          \PY{n}{f\PYZus{}Dlayer} \PY{o}{=} \PY{n}{tensor\PYZus{}gen\PYZus{}D}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{(}\PY{n}{tensor\PYZus{}gen\PYZus{}D}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tpep\PYZus{}pickup\PYZus{}datetime}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{\PYZgt{}}\PY{o}{=} \PY{n}{intervals}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)} \PY{o}{\PYZam{}}
                                      \PY{p}{(}\PY{n}{tensor\PYZus{}gen\PYZus{}D}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tpep\PYZus{}dropoff\PYZus{}datetime}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{\PYZlt{}} \PY{n}{intervals}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
                                     \PY{p}{]}
          
          \PY{n+nb}{print}\PY{p}{(}\PY{n}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{f\PYZus{}olayer.shape: }\PY{l+s+si}{\PYZob{}f\PYZus{}olayer.shape\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{n}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{f\PYZus{}Ilayer.shape: }\PY{l+s+si}{\PYZob{}f\PYZus{}Ilayer.shape\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{} There will be no incoming trips for the first snapshot.}
          \PY{n+nb}{print}\PY{p}{(}\PY{n}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{f\PYZus{}Dlayer.shape: }\PY{l+s+si}{\PYZob{}f\PYZus{}Dlayer.shape\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
f\_olayer.shape: (1545, 5)
f\_Ilayer.shape: (0, 5)
f\_Dlayer.shape: (206, 5)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}94}]:} \PY{c+c1}{\PYZsh{} Check if the trips add up:}
         \PY{k}{assert} \PY{n}{first}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{==} \PY{n}{f\PYZus{}olayer}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{+} \PY{n}{f\PYZus{}Ilayer}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{+} \PY{n}{f\PYZus{}Dlayer}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
         \PY{n}{f\PYZus{}olayer}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{20}\PY{p}{)}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}94}]:}       tripid tpep\_pickup\_datetime tpep\_dropoff\_datetime  pulocationid  \textbackslash{}
         28  25754928           2017-01-01   2017-01-01 00:10:00           239   
         83  25754985           2017-01-01   2017-01-01 00:10:00           113   
         10  25754909           2017-01-01   2017-01-01 00:11:00           142   
         54  25754954           2017-01-01   2017-01-01 00:11:00           264   
         74  25754976           2017-01-01   2017-01-01 00:11:00           162   
         21  25754920           2017-01-01   2017-01-01 00:12:00           125   
         25  25754924           2017-01-01   2017-01-01 00:12:00            68   
         41  25754941           2017-01-01   2017-01-01 00:12:00           138   
         53  25754953           2017-01-01   2017-01-01 00:12:00           113   
         61  25754962           2017-01-01   2017-01-01 00:12:00           263   
         62  25754963           2017-01-01   2017-01-01 00:12:00            41   
         72  25754973           2017-01-01   2017-01-01 00:12:00           239   
         27  25754926           2017-01-01   2017-01-01 00:13:00           233   
         69  25754970           2017-01-01   2017-01-01 00:13:00            45   
         75  25754977           2017-01-01   2017-01-01 00:13:00           262   
         78  25754980           2017-01-01   2017-01-01 00:14:00           148   
         80  25754982           2017-01-01   2017-01-01 00:14:00           233   
         84  25754986           2017-01-01   2017-01-01 00:14:00           246   
         9   25754908           2017-01-01   2017-01-01 00:15:00           138   
         24  25754923           2017-01-01   2017-01-01 00:15:00           140   
         
             dolocationid  
         28            48  
         83           137  
         10           236  
         54           264  
         74            45  
         21            45  
         25            48  
         41            80  
         53           229  
         61             7  
         62           235  
         72           229  
         27           114  
         69           137  
         75            90  
         78             7  
         80            74  
         84           186  
         9            262  
         24           223  
\end{Verbatim}
            
    Each pair of (pulocationid - 1, dolocationid - 1) indicates adding one
to the snapshot:

    Before generating image, we have to map the zone id to a range from 0 to
54:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}129}]:} \PY{n}{real\PYZus{}id} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n+nb}{map}\PY{p}{(}\PY{n+nb}{str}\PY{p}{,} \PY{n+nb}{list}\PY{p}{(}\PY{n}{y\PYZus{}zone}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{LocationID}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{p}{)}
          \PY{n}{conv\PYZus{}id} \PY{o}{=} \PY{p}{[}\PY{n}{i} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{img\PYZus{}size}\PY{p}{)}\PY{p}{]}
          \PY{k}{assert} \PY{n+nb}{len}\PY{p}{(}\PY{n}{real\PYZus{}id}\PY{p}{)} \PY{o}{==} \PY{n+nb}{len}\PY{p}{(}\PY{n}{conv\PYZus{}id}\PY{p}{)}
          \PY{n}{mp} \PY{o}{=} \PY{n+nb}{dict}\PY{p}{(}\PY{n+nb}{zip}\PY{p}{(}\PY{n}{real\PYZus{}id}\PY{p}{,} \PY{n}{conv\PYZus{}id}\PY{p}{)}\PY{p}{)}
          \PY{c+c1}{\PYZsh{} the line below is a dirty fix, be causious in future!}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}122}]:} \PY{c+c1}{\PYZsh{} create a snapshot:}
          \PY{n}{first\PYZus{}snapshot} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{[}\PY{n}{img\PYZus{}size}\PY{p}{,} \PY{n}{img\PYZus{}size}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{]}\PY{p}{,} \PY{n}{dtype}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{float64}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{n}{first\PYZus{}snapshot}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{n}{first\PYZus{}snapshot}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
          
          \PY{n}{left\PYZus{}zones} \PY{o}{=} \PY{n+nb}{set}\PY{p}{(}\PY{p}{)}
          
          \PY{k}{for} \PY{n}{\PYZus{}}\PY{p}{,} \PY{n}{row} \PY{o+ow}{in} \PY{n}{f\PYZus{}olayer}\PY{o}{.}\PY{n}{iterrows}\PY{p}{(}\PY{p}{)}\PY{p}{:}
              \PY{k}{try}\PY{p}{:}
                  \PY{n}{first\PYZus{}snapshot}\PY{p}{[}\PY{n}{mp}\PY{p}{[}\PY{n+nb}{str}\PY{p}{(}\PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pulocationid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{]}\PY{p}{,} \PY{n}{mp}\PY{p}{[}\PY{n+nb}{str}\PY{p}{(}\PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dolocationid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{]}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{]} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1} \PY{c+c1}{\PYZsh{} inplace increment 1 in numpy}
              \PY{k}{except} \PY{n+ne}{Exception} \PY{k}{as} \PY{n}{e}\PY{p}{:}
                  \PY{n}{left\PYZus{}zones}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n+nb}{str}\PY{p}{(}\PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pulocationid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}
                  \PY{n}{left\PYZus{}zones}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n+nb}{str}\PY{p}{(}\PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dolocationid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}
          
          \PY{k}{for} \PY{n}{\PYZus{}}\PY{p}{,} \PY{n}{row} \PY{o+ow}{in} \PY{n}{f\PYZus{}Ilayer}\PY{o}{.}\PY{n}{iterrows}\PY{p}{(}\PY{p}{)}\PY{p}{:}
              \PY{k}{try}\PY{p}{:}
                  \PY{n}{first\PYZus{}snapshot}\PY{p}{[}\PY{n}{mp}\PY{p}{[}\PY{n+nb}{str}\PY{p}{(}\PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pulocationid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{]}\PY{p}{,} \PY{n}{mp}\PY{p}{[}\PY{n+nb}{str}\PY{p}{(}\PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dolocationid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{]}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
              \PY{k}{except} \PY{n+ne}{Exception} \PY{k}{as} \PY{n}{e}\PY{p}{:}
                  \PY{n}{left\PYZus{}zones}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n+nb}{str}\PY{p}{(}\PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pulocationid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}
                  \PY{n}{left\PYZus{}zones}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n+nb}{str}\PY{p}{(}\PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dolocationid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}
          
          \PY{k}{for} \PY{n}{\PYZus{}}\PY{p}{,} \PY{n}{row} \PY{o+ow}{in} \PY{n}{f\PYZus{}Dlayer}\PY{o}{.}\PY{n}{iterrows}\PY{p}{(}\PY{p}{)}\PY{p}{:}
              \PY{k}{try}\PY{p}{:}
                  \PY{n}{first\PYZus{}snapshot}\PY{p}{[}\PY{n}{mp}\PY{p}{[}\PY{n+nb}{str}\PY{p}{(}\PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pulocationid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{]}\PY{p}{,} \PY{n}{mp}\PY{p}{[}\PY{n+nb}{str}\PY{p}{(}\PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dolocationid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{]}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{]} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
              \PY{k}{except} \PY{n+ne}{Exception} \PY{k}{as} \PY{n}{e}\PY{p}{:}
                  \PY{n}{left\PYZus{}zones}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n+nb}{str}\PY{p}{(}\PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pulocationid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}
                  \PY{n}{left\PYZus{}zones}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n+nb}{str}\PY{p}{(}\PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dolocationid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}
          
          \PY{n+nb}{print}\PY{p}{(}\PY{n}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{left\PYZus{}zones: }\PY{l+s+si}{\PYZob{}left\PYZus{}zones\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{n}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{left\PYZus{}zones length: }\PY{l+s+s1}{\PYZob{}}\PY{l+s+s1}{len(left\PYZus{}zones)\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          
          \PY{n+nb}{print}\PY{p}{(}\PY{n}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{O max \PYZhy{}\PYZgt{} }\PY{l+s+s1}{\PYZob{}}\PY{l+s+s1}{first\PYZus{}snapshot[:,:,0].max()\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{n}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{I max \PYZhy{}\PYZgt{} }\PY{l+s+s1}{\PYZob{}}\PY{l+s+s1}{first\PYZus{}snapshot[:,:,1].max()\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{n}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{D max \PYZhy{}\PYZgt{} }\PY{l+s+s1}{\PYZob{}}\PY{l+s+s1}{first\PYZus{}snapshot[:,:,2].max()\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} convert numpy array to a image:}
          \PY{n}{tb} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{first\PYZus{}snapshot}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
          
          
          \PY{n}{first\PYZus{}snapshot} \PY{o}{*}\PY{o}{=} \PY{l+m+mi}{255}\PY{o}{/}\PY{o}{/}\PY{n}{first\PYZus{}snapshot}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
(69, 69, 3)
0.0
left\_zones: \{'142', '62', '25', '213', '182', '198', '238', '165', '137', '88', '144', '179', '140', '148', '97', '260', '126', '226', '90', '255', '65', '125', '50', '12', '33', '76', '134', '235', '107', '48', '4', '168', '53', '80', '189', '242', '138', '75', '114', '42', '47', '26', '217', '193', '263', '37', '92', '228', '71', '73', '28', '211', '170', '7', '82', '130', '183', '69', '225', '68', '166', '181', '13', '256', '229', '174', '66', '41', '233', '265', '106', '220', '108', '247', '35', '187', '248', '70', '232', '43', '163', '141', '147', '160', '10', '93', '45', '52', '173', '17', '89', '22', '18', '236', '161', '159', '262', '200', '112', '61', '231', '51', '164', '85', '20', '223', '230', '145', '129', '77', '157', '246', '192', '162', '113', '239', '188', '14', '91', '40', '243', '224', '119', '36', '177', '49', '186', '264', '249', '74', '72', '158', '79', '146', '132', '38', '234', '190', '95', '151', '216'\}
left\_zones length: 141
O max -> 8.0
I max -> 0.0
D max -> 4.0

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{c+c1}{\PYZsh{} Plot OID layer values:}
        \PY{n}{temp\PYZus{}o} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{reshape}\PY{p}{(}\PY{n}{first\PYZus{}snapshot}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
        \PY{n}{temp\PYZus{}i} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{reshape}\PY{p}{(}\PY{n}{first\PYZus{}snapshot}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
        \PY{n}{temp\PYZus{}d} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{reshape}\PY{p}{(}\PY{n}{first\PYZus{}snapshot}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{,} \PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}143}]:} \PY{n}{sns}\PY{o}{.}\PY{n}{distplot}\PY{p}{(}\PY{n}{temp\PYZus{}o}\PY{p}{,} \PY{n}{axlabel}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{out\PYZhy{}going(Red)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{red}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{;}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_57_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}144}]:} \PY{n}{sns}\PY{o}{.}\PY{n}{distplot}\PY{p}{(}\PY{n}{temp\PYZus{}i}\PY{p}{,} \PY{n}{axlabel}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{in\PYZhy{}coming(Green)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{green}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{;}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_58_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}145}]:} \PY{n}{sns}\PY{o}{.}\PY{n}{distplot}\PY{p}{(}\PY{n}{temp\PYZus{}d}\PY{p}{,} \PY{n}{axlabel}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{domestic(Blue)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{blue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{;}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_59_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}140}]:} \PY{n}{first\PYZus{}snapshot} \PY{o}{=} \PY{n}{first\PYZus{}snapshot}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{uint8}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{first\PYZus{}image} \PY{o}{=} \PY{n}{Image}\PY{o}{.}\PY{n}{fromarray}\PY{p}{(}\PY{n}{first\PYZus{}snapshot}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}141}]:} \PY{n}{tb}
\end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}141}]:}       0    1     2     3     4     5     6     7      8      9   {\ldots}       59  \textbackslash{}
          0    0.0  0.0   0.0   0.0   0.0   0.0   0.0   0.0    0.0    0.0  {\ldots}      0.0   
          1    0.0  0.0   0.0   0.0   0.0   0.0   0.0   0.0    0.0    0.0  {\ldots}      0.0   
          2    0.0  0.0   0.0   0.0   0.0   0.0   0.0   0.0    0.0    0.0  {\ldots}      0.0   
          3    0.0  0.0   0.0   0.0   0.0  31.0   0.0   0.0    0.0   31.0  {\ldots}      0.0   
          4    0.0  0.0   0.0   0.0   0.0   0.0   0.0   0.0    0.0    0.0  {\ldots}      0.0   
          5    0.0  0.0   0.0   0.0  62.0   0.0   0.0   0.0    0.0    0.0  {\ldots}      0.0   
          6    0.0  0.0   0.0   0.0   0.0   0.0   0.0   0.0    0.0    0.0  {\ldots}     62.0   
          7    0.0  0.0   0.0   0.0   0.0   0.0   0.0   0.0    0.0    0.0  {\ldots}      0.0   
          8    0.0  0.0  31.0  62.0  31.0  31.0   0.0   0.0  124.0  124.0  {\ldots}      0.0   
          9    0.0  0.0   0.0   0.0   0.0   0.0   0.0   0.0    0.0    0.0  {\ldots}     31.0   
          10   0.0  0.0  31.0   0.0   0.0   0.0   0.0   0.0  155.0  124.0  {\ldots}      0.0   
          11   0.0  0.0   0.0   0.0   0.0  31.0   0.0   0.0    0.0    0.0  {\ldots}      0.0   
          12   0.0  0.0   0.0   0.0  31.0   0.0   0.0   0.0    0.0    0.0  {\ldots}      0.0   
          13  62.0  0.0  31.0   0.0  31.0   0.0   0.0   0.0   62.0    0.0  {\ldots}      0.0   
          14   0.0  0.0   0.0   0.0   0.0   0.0   0.0   0.0   31.0    0.0  {\ldots}      0.0   
          15   0.0  0.0   0.0   0.0   0.0   0.0   0.0   0.0    0.0    0.0  {\ldots}      0.0   
          16   0.0  0.0   0.0   0.0  31.0   0.0   0.0   0.0    0.0   93.0  {\ldots}      0.0   
          17   0.0  0.0   0.0   0.0   0.0   0.0   0.0   0.0    0.0   31.0  {\ldots}      0.0   
          18   0.0  0.0   0.0   0.0   0.0   0.0   0.0   0.0    0.0    0.0  {\ldots}      0.0   
          19   0.0  0.0   0.0   0.0   0.0   0.0   0.0   0.0    0.0    0.0  {\ldots}      0.0   
          20   0.0  0.0   0.0   0.0   0.0   0.0   0.0   0.0    0.0    0.0  {\ldots}      0.0   
          21   0.0  0.0   0.0   0.0   0.0   0.0   0.0   0.0   62.0    0.0  {\ldots}      0.0   
          22  62.0  0.0   0.0   0.0   0.0   0.0   0.0   0.0   31.0    0.0  {\ldots}      0.0   
          23  31.0  0.0   0.0   0.0   0.0   0.0   0.0   0.0   31.0    0.0  {\ldots}     31.0   
          24   0.0  0.0   0.0   0.0   0.0   0.0   0.0   0.0    0.0    0.0  {\ldots}      0.0   
          25   0.0  0.0   0.0   0.0   0.0   0.0   0.0   0.0    0.0    0.0  {\ldots}      0.0   
          26   0.0  0.0  31.0   0.0   0.0   0.0   0.0  31.0   31.0    0.0  {\ldots}     31.0   
          27   0.0  0.0   0.0   0.0   0.0  31.0   0.0   0.0    0.0    0.0  {\ldots}      0.0   
          28   0.0  0.0   0.0   0.0   0.0   0.0   0.0   0.0    0.0    0.0  {\ldots}      0.0   
          29   0.0  0.0   0.0   0.0   0.0   0.0   0.0   0.0    0.0    0.0  {\ldots}      0.0   
          ..   {\ldots}  {\ldots}   {\ldots}   {\ldots}   {\ldots}   {\ldots}   {\ldots}   {\ldots}    {\ldots}    {\ldots}  {\ldots}      {\ldots}   
          39  62.0  0.0   0.0   0.0   0.0   0.0   0.0  31.0   93.0    0.0  {\ldots}      0.0   
          40   0.0  0.0  31.0   0.0  31.0   0.0  31.0   0.0    0.0   93.0  {\ldots}     62.0   
          41   0.0  0.0   0.0   0.0   0.0  31.0   0.0  93.0    0.0    0.0  {\ldots}      0.0   
          42   0.0  0.0   0.0  31.0   0.0   0.0  31.0   0.0    0.0    0.0  {\ldots}     31.0   
          43   0.0  0.0  31.0   0.0   0.0   0.0   0.0   0.0   62.0   31.0  {\ldots}      0.0   
          44   0.0  0.0   0.0   0.0   0.0   0.0   0.0   0.0    0.0    0.0  {\ldots}      0.0   
          45   0.0  0.0   0.0   0.0   0.0   0.0  31.0   0.0    0.0    0.0  {\ldots}     31.0   
          46   0.0  0.0   0.0   0.0   0.0   0.0   0.0   0.0   62.0   93.0  {\ldots}      0.0   
          47   0.0  0.0   0.0   0.0   0.0   0.0   0.0   0.0    0.0    0.0  {\ldots}      0.0   
          48   0.0  0.0   0.0   0.0   0.0   0.0   0.0   0.0    0.0    0.0  {\ldots}      0.0   
          49   0.0  0.0  62.0   0.0   0.0  31.0   0.0   0.0    0.0    0.0  {\ldots}      0.0   
          50  62.0  0.0  31.0   0.0   0.0   0.0   0.0   0.0   31.0   31.0  {\ldots}      0.0   
          51   0.0  0.0   0.0   0.0   0.0   0.0   0.0   0.0    0.0    0.0  {\ldots}      0.0   
          52   0.0  0.0   0.0   0.0   0.0   0.0   0.0   0.0   31.0    0.0  {\ldots}      0.0   
          53   0.0  0.0  31.0   0.0   0.0   0.0   0.0   0.0    0.0   31.0  {\ldots}     31.0   
          54   0.0  0.0  31.0   0.0   0.0   0.0   0.0   0.0   31.0    0.0  {\ldots}      0.0   
          55  62.0  0.0   0.0   0.0   0.0   0.0   0.0  31.0    0.0    0.0  {\ldots}      0.0   
          56   0.0  0.0   0.0   0.0   0.0   0.0   0.0   0.0    0.0    0.0  {\ldots}      0.0   
          57   0.0  0.0  31.0  31.0  31.0  31.0   0.0  31.0   31.0   31.0  {\ldots}      0.0   
          58   0.0  0.0  31.0   0.0   0.0   0.0   0.0   0.0    0.0    0.0  {\ldots}      0.0   
          59   0.0  0.0   0.0  31.0   0.0   0.0  31.0   0.0   31.0    0.0  {\ldots}    124.0   
          60   0.0  0.0  31.0  62.0   0.0   0.0   0.0   0.0   31.0    0.0  {\ldots}      0.0   
          61   0.0  0.0   0.0   0.0   0.0   0.0   0.0   0.0  155.0   62.0  {\ldots}     31.0   
          62   0.0  0.0   0.0   0.0   0.0   0.0   0.0   0.0    0.0    0.0  {\ldots}      0.0   
          63   0.0  0.0   0.0  31.0   0.0   0.0   0.0   0.0    0.0    0.0  {\ldots}      0.0   
          64   0.0  0.0   0.0   0.0   0.0   0.0  31.0   0.0  186.0    0.0  {\ldots}      0.0   
          65  31.0  0.0  31.0   0.0   0.0   0.0   0.0   0.0   31.0    0.0  {\ldots}      0.0   
          66   0.0  0.0   0.0   0.0   0.0   0.0   0.0   0.0    0.0    0.0  {\ldots}      0.0   
          67   0.0  0.0   0.0   0.0  31.0  31.0   0.0   0.0   31.0    0.0  {\ldots}      0.0   
          68   0.0  0.0   0.0   0.0  62.0   0.0   0.0   0.0    0.0    0.0  {\ldots}     31.0   
          
                 60    61    62    63     64     65    66    67     68  
          0     0.0   0.0   0.0   0.0    0.0   31.0   0.0   0.0    0.0  
          1     0.0   0.0   0.0   0.0    0.0    0.0   0.0   0.0    0.0  
          2     0.0   0.0   0.0   0.0    0.0    0.0   0.0   0.0    0.0  
          3     0.0   0.0   0.0   0.0    0.0    0.0   0.0   0.0    0.0  
          4    31.0  62.0   0.0   0.0    0.0    0.0   0.0   0.0    0.0  
          5     0.0   0.0   0.0  31.0    0.0    0.0   0.0   0.0   31.0  
          6    62.0   0.0   0.0   0.0    0.0    0.0   0.0   0.0   31.0  
          7     0.0   0.0   0.0   0.0    0.0    0.0   0.0   0.0    0.0  
          8     0.0  62.0  31.0   0.0   62.0    0.0  31.0   0.0   31.0  
          9     0.0   0.0   0.0  31.0    0.0    0.0   0.0   0.0    0.0  
          10   62.0   0.0  31.0  31.0  155.0    0.0   0.0   0.0    0.0  
          11    0.0   0.0   0.0   0.0    0.0    0.0   0.0   0.0    0.0  
          12    0.0   0.0   0.0   0.0    0.0    0.0   0.0   0.0   31.0  
          13   31.0  31.0   0.0   0.0   31.0   62.0  31.0  62.0  124.0  
          14   31.0   0.0   0.0   0.0    0.0    0.0   0.0   0.0    0.0  
          15    0.0   0.0   0.0   0.0    0.0    0.0   0.0   0.0    0.0  
          16   93.0  31.0   0.0   0.0   62.0   31.0   0.0  31.0   62.0  
          17    0.0   0.0  31.0   0.0    0.0    0.0   0.0   0.0    0.0  
          18    0.0   0.0   0.0   0.0    0.0    0.0   0.0   0.0    0.0  
          19    0.0   0.0   0.0   0.0    0.0    0.0   0.0   0.0    0.0  
          20    0.0   0.0   0.0   0.0    0.0    0.0   0.0   0.0    0.0  
          21    0.0  62.0   0.0   0.0    0.0   31.0   0.0   0.0    0.0  
          22    0.0  31.0   0.0  31.0    0.0    0.0   0.0   0.0    0.0  
          23   93.0  62.0   0.0   0.0    0.0   62.0   0.0  31.0   62.0  
          24    0.0   0.0   0.0   0.0    0.0    0.0   0.0   0.0    0.0  
          25    0.0   0.0   0.0   0.0    0.0    0.0   0.0   0.0    0.0  
          26    0.0   0.0   0.0   0.0    0.0    0.0   0.0   0.0   62.0  
          27    0.0   0.0   0.0   0.0    0.0    0.0   0.0   0.0    0.0  
          28    0.0   0.0   0.0   0.0    0.0    0.0   0.0   0.0    0.0  
          29    0.0   0.0   0.0   0.0    0.0   31.0   0.0   0.0    0.0  
          ..    {\ldots}   {\ldots}   {\ldots}   {\ldots}    {\ldots}    {\ldots}   {\ldots}   {\ldots}    {\ldots}  
          39    0.0  31.0   0.0   0.0   31.0   93.0   0.0   0.0   31.0  
          40    0.0   0.0   0.0   0.0    0.0    0.0   0.0   0.0   31.0  
          41    0.0   0.0   0.0   0.0    0.0    0.0   0.0   0.0   62.0  
          42    0.0  62.0   0.0   0.0    0.0    0.0   0.0   0.0    0.0  
          43    0.0   0.0   0.0   0.0   62.0    0.0   0.0  31.0    0.0  
          44    0.0  31.0   0.0   0.0    0.0    0.0   0.0   0.0    0.0  
          45   31.0   0.0  31.0   0.0   31.0   31.0   0.0  31.0   31.0  
          46    0.0   0.0   0.0   0.0    0.0   31.0   0.0   0.0   62.0  
          47    0.0   0.0   0.0   0.0    0.0    0.0   0.0   0.0    0.0  
          48    0.0   0.0   0.0   0.0    0.0    0.0   0.0   0.0    0.0  
          49    0.0   0.0   0.0   0.0    0.0    0.0   0.0   0.0    0.0  
          50    0.0   0.0   0.0   0.0    0.0    0.0  31.0   0.0    0.0  
          51    0.0   0.0   0.0   0.0    0.0    0.0   0.0   0.0    0.0  
          52    0.0   0.0   0.0   0.0    0.0    0.0   0.0  31.0   31.0  
          53    0.0   0.0   0.0   0.0   31.0    0.0   0.0   0.0    0.0  
          54    0.0   0.0   0.0   0.0    0.0   31.0  62.0   0.0    0.0  
          55    0.0   0.0   0.0   0.0    0.0    0.0   0.0  31.0    0.0  
          56    0.0   0.0   0.0   0.0    0.0    0.0   0.0   0.0   62.0  
          57    0.0  31.0   0.0   0.0   31.0   62.0  31.0   0.0   31.0  
          58   31.0   0.0   0.0   0.0    0.0    0.0   0.0   0.0    0.0  
          59  124.0   0.0   0.0   0.0    0.0    0.0   0.0  31.0   31.0  
          60   31.0  31.0   0.0  31.0    0.0    0.0   0.0   0.0    0.0  
          61   31.0  62.0   0.0  62.0    0.0    0.0   0.0   0.0   31.0  
          62    0.0   0.0   0.0  31.0    0.0    0.0   0.0   0.0    0.0  
          63    0.0   0.0   0.0  31.0    0.0    0.0   0.0   0.0    0.0  
          64    0.0   0.0   0.0   0.0   62.0   31.0   0.0  31.0    0.0  
          65   31.0   0.0   0.0   0.0   31.0  124.0   0.0   0.0   31.0  
          66    0.0   0.0   0.0   0.0    0.0    0.0   0.0   0.0    0.0  
          67    0.0  31.0   0.0   0.0    0.0    0.0   0.0  31.0    0.0  
          68   62.0  31.0   0.0  31.0    0.0    0.0   0.0  31.0    0.0  
          
          [69 rows x 69 columns]
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}142}]:} \PY{n}{first\PYZus{}image}\PY{o}{.}\PY{n}{resize}\PY{p}{(}\PY{p}{(}\PY{l+m+mi}{250}\PY{p}{,}\PY{l+m+mi}{250}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\texttt{\color{outcolor}Out[{\color{outcolor}142}]:}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_62_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}38}]:} \PY{n}{first\PYZus{}image}\PY{o}{.}\PY{n}{resize}\PY{p}{(}\PY{p}{(}\PY{l+m+mi}{250}\PY{p}{,}\PY{l+m+mi}{250}\PY{p}{)}\PY{p}{)}\PY{o}{.}\PY{n}{save}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]

        ---------------------------------------------------------------------------

        TypeError                                 Traceback (most recent call last)

        <ipython-input-38-6263e863fbd5> in <module>
    ----> 1 first\_image.resize((250,250)).save()
    

        TypeError: save() missing 1 required positional argument: 'fp'

    \end{Verbatim}

    Now, slice the \texttt{tensor\_gen} into 4464 sub tables:


    % Add a bibliography block to the postdoc
    
    
    
    \end{document}
